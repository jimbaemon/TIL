# 인터넷 통신

>  인터넷에서의 통신간 출발지와 도착지를 알기 위해서 각각의 고유한 주소를 알수있는 IP (Internet Protocol)가 존재한다.



## IP (Internet Protocol)

* IP 는 출발지와 도착지 정보의 주소와 메시지를 담은 패킷을 통해 통신한다.



**전송예시**

![image-20201229225903333](http://www.jimbae.com:59005/image/12)

**응답예시**

![image-20201229230414245](http://www.jimbae.com:59005/image/13)



### IP프로토콜의 한계

* **비연결성**
  * 패킷이 받을 대상이 없어서 전송을 진행한다.
* **비신뢰성**
  * 중간에 패킷이 사라질 경우에 대한 방안이 없음
  * 패킷의 순서를 보장하지 않음
* **프로그램 구분**
  * 같은 IP 에서 사용하는 여러 어플리케이션 구분이 불가능



**비연결성 문제 예시**

![image-20201229230936389](http://www.jimbae.com:59005/image/14)

**비신뢰성 예시**

![image-20201229231044623](http://www.jimbae.com:59005/image/15)

![image-20201229231106323](http://www.jimbae.com:59005/image/16)

**위와 같은 IP 프로토콜의 한계를 극복하기 위해 TCP/UDP 프로토콜이 사용된다.**



## TCP/UDP

> 시작전에 인터넷 프로토콜 스택의 4계층을 살펴보자

**인터넷 프로토콜 스택의 4계층은 아래와 같다.**

![image-20201230224459604](http://www.jimbae.com:59005/image/17)

**이것을 우리가 사용하는 어플리케이션 등에 대입하면 이와 같다.**

![image-20201230224610381](http://www.jimbae.com:59005/image/18)

**메시지 전송중 일어나는 일을 4계층에 대입하면 아래와 같다.**

![image-20201231175626152](http://www.jimbae.com:59005/image/19)

위의 이미지를 보면 각계층별로 메시지, 데이터 등을 포함됨을 알수 있다.

계층별로 추가되는 데이터는 아래와 같다

**IP 계층의 패킷**

![image-20210101214127171](http://www.jimbae.com:59005/image/20)



**TCP/UDP 계층의 세그먼트**

![image-20210101214236773](http://www.jimbae.com:59005/image/21)

TCP 세그먼트 내에는 출발지 PORT, 목적지 PORT, 전송 제어 정보, 순서 정보, 검증 정보 등이 추가되어

위에서 말한 IP 프로토콜의 한계인 `비연결성`, `비신뢰성`, `프로그램 구분 불가능` 의 문제점이 해결 가능하다.



#### TCP 특징

* **연결지향 - TCP 3 way handshake** 
* **데이터 전달 보증**
* **순서 보장**



**TCP 3way handshake 예제**

![image-20210101214810198](http://www.jimbae.com:59005/image/22)

1. `클라이언트`는 연결할 `서버`에 SYN 을 보내 연결을 요청한다
2. `서버` 는 SYN 을 받으면 `서버`는 자신이 살아 있음을 SYN 을 보내 알리고 ACK 를 함꼐 보내서 연결을 수락한다
3. `클라이언트`는 서버가 살아 있음을 확인하고 ACK 를 다시 보내주어 연결을 한다.



**데이터 전달 보증 예제**

![image-20210101215937492](http://www.jimbae.com:59005/image/23)

**순서 보장 예제**

![image-20210101220002924](http://www.jimbae.com:59005/image/24)



#### UDP 의 특징

* IP + PORT + 체크섬 기능 정도만 있다.



## PORT

하나의 IP 를 가진 컴퓨터에서는 우리는 음악을 듣고, 게임을 하고 영상을 보는등 다양한 활동을 동시에 한다.

이렇게 하나의 IP 에서 프로그램별로 주고 받는 데이터는 PORT 를 통해 구분이 가능하다.



**PORT 사용 예시**

![image-20210101221553145](http://www.jimbae.com:59005/image/25)

* 게임은 11220 포트로 서버에 게임에 대한 정보를 요청하고 서버는 게임에 대한 정보를 8090 포트로 돌려준다.
* 이렇게 상호간 포트를 알수 있는 이유는 TCP 세그먼트에 출발지 PORT 와 도착지 PORT 정보가 존재하기 때문이다.



**포트 종류**

* 0 ~ 65535 : 할당 가능 포트 
* 0 ~ 1023 : 잘 알려진 포트, 사용하지 않는 것이 좋음
  * FTP : 20, 21
  * SFTP, SSH : 22
  * TELNET : 23
  * HTTP : 80
  * HTTPS : 443



## DNS

* IP 는 기억하기도 어렵고 또한 변경될 가능성도 있다.
* 이러한 문제를 해결하기 위해 특정 도메인의  IP 를 저장하는 DNS 서버가 존재한다.

![image-20210101222659619](http://www.jimbae.com:59005/image/26)

* google.com, aaa.com 등과 같이 사용자가 기억하기 쉽도록 주소를 입력하면 DNS 는 해당 도메인에 매핑되는 IP를 사용자에게 알려준다.
* IP가 변경되더라도 DNS 서버 정보만 갱신하면 되므로 사용자와는 무관하다.